# cards.py

RULES_TEXT = """В игре три раунда, в каждом из которых игроку и боту-хакеру выдается по 10 карт таким образом, чтобы игрок точно смог отразить атаку.
В каждом раунде у противников изначально по 5 очков здоровья.
При удачной защите игроку прибавляется по 1-2 очка, а у хакера – снимается столько же, в зависимости от выбранной защитной карты.
При неудачной защите у хакера всегда прибавляется 2 очка, а у игрока отнимается 2 очка.
Для победы в раунде необходимо набрать 10 очков.
На один ход дается 60 секунд, и если карта защиты не выбрана до истечения времени, у игрока автоматически снимаются очки.
Чтобы выиграть матч, игрок должен победить в 2 из 3 раундов.
"""

ATTACK_CARDS = [
    "Фишинговая атака", "DDoS-атака", "Эксплойт уязвимости", "Брутфорс-атака", "Социальная инженерия",
    "SQL-инъекция", "Злоумышленный инсайдер", "Атака на цепочку поставок", "API-атака", 
    "Злоупотребление доверенными устройствами", "Взлом IoT-устройств", "Поддельные обновления", 
    "ИИ-атака", "Кража куки-файлов", "Бэкдор", "DNS-спуфинг", "Bluetooth-взлом", "Кража токенов доступа",
    "Прослушка в общественном Wi-Fi", "USB-атака", "Руткит", "Vishing"
]

DEFENSE_CARDS = [
    "Обучение сотрудников", "Применение DMARC", "Настройка WAF", "Анализ сетевого трафика", 
    "Регулярное обновление ПО", "Тесты на проникновение", "Запрет слабых паролей", 
    "Многофакторная аутентификация", "Мониторинг активности пользователей", "Шифрование базы данных",
    "Удаление неиспользуемых аккаунтов", "Обновление ПО из доверенных источников", 
    "Проверка кода перед развертыванием", "Ограничение доступа по IP", "Аудит безопасности API",
    "Контроль списка устройств", "Изоляция IoT в сети", "Проверка цифровых подписей", 
    "Обновление ПО вручную", "Использование VPN", "Очистка кэша браузера", 
    "Ограничение времени жизни токенов", "Фильтрация DNS-запросов", 
    "Отключение Bluetooth", "Отключение автоподключения к Wi-Fi", "Ограничение использования USB",
    "Мониторинг активности USB-портов", "Изоляция подозрительных процессов", 
    "Антивирус с поведенческим анализом", "Анализ подозрительных звонков"
]

CARD_DESCRIPTIONS = {
    "Фишинговая атака": "Хакеры отправляют поддельные электронные письма, маскируясь под доверенные источники, чтобы обманом получить учетные данные пользователей, такие как логины и пароли.",
    "DDoS-атака": "Хакеры перегружают сервер или сеть огромным количеством запросов, вызывая отказ в обслуживании и делая систему недоступной для легитимных пользователей.",
    "Эксплойт уязвимости": "Хакеры используют известные или неизвестные уязвимости в программном обеспечении, чтобы получить несанкционированный доступ или выполнить вредоносный код.",
    "Брутфорс-атака": "Метод подбора паролей путём систематического перебора возможных комбинаций с применением автоматизированных инструментов для взлома системы.",
    "Социальная инженерия": "Манипуляция людьми с использованием психологических приёмов для получения доступа к конфиденциальной информации или системам.",
    "SQL-инъекция": "Внедрение вредоносных SQL-запросов в веб-приложения с целью получения доступа к базам данных, их изменения или кражи содержимого.",
    "Злоумышленный инсайдер": "Сотрудник или лицо с легитимным доступом, которое умышленно использует свои права для нанесения ущерба организации или передачи данных третьим лицам.",
    "Атака на цепочку поставок": "Хакеры заражают программное обеспечение или оборудование на этапе разработки или поставки, внедряя вредоносный код для последующих атак.",
    "API-атака": "Хакеры эксплуатируют уязвимости в API, чтобы получить доступ к данным, перехватить запросы или нарушить работу приложения.",
    "Злоупотребление доверенными устройствами": "Хакеры используют ранее авторизованные устройства для обхода защитных механизмов и получения доступа к системе.",
    "Взлом IoT-устройств": "Хакеры атакуют уязвимые 'умные' устройства (например, камеры), чтобы проникнуть в сеть или использовать их для других атак.",
    "Поддельные обновления": "Хакеры распространяют фальшивые обновления ПО, содержащие вредоносный код, чтобы заразить системы пользователей.",
    "ИИ-атака": "Применение искусственного интеллекта для автоматизации атак, таких как подбор паролей или поиск уязвимостей.",
    "Кража куки-файлов": "Перехват файлов cookie через незащищённые соединения для доступа к пользовательским аккаунтам без ввода учётных данных.",
    "Бэкдор": "Создание скрытого механизма в системе, позволяющего обойти стандартные меры защиты и получить доступ.",
    "DNS-спуфинг": "Хакеры подменяют DNS-запросы, перенаправляя пользователей на поддельные сайты для кражи данных или распространения вредоносного ПО.",
    "Bluetooth-взлом": "Хакеры используют уязвимости Bluetooth для перехвата данных или управления устройствами в радиусе действия.",
    "Кража токенов доступа": "Хакеры похищают токены аутентификации, чтобы войти в систему от имени легитимного пользователя.",
    "Прослушка в общественном Wi-Fi": "Хакеры перехватывают незашифрованный трафик в открытых сетях Wi-Fi, крадя данные или учетные записи.",
    "USB-атака": "Хакеры используют USB-устройства для внедрения вредоносного ПО в систему при подключении к компьютеру.",
    "Руткит": "Хакеры устанавливают скрытое ПО, которое маскируется в системе, предоставляя полный контроль и скрывая свою активность.",
    "Vishing": "Хакеры используют телефонные звонки, выдавая себя за доверенных лиц, чтобы обманом выманить конфиденциальные данные.",
    "Обучение сотрудников": "Регулярное обучение персонала методам распознавания киберугроз, таких как фишинг и социальная инженерия, для повышения общей безопасности.",
    "Применение DMARC": "Настройка политики DMARC для проверки подлинности отправителей писем и защиты от фишинга через поддельные домены.",
    "Настройка WAF": "Использование веб-файрвола (WAF) для фильтрации трафика и предотвращения атак, таких как SQL-инъекции или DDoS.",
    "Анализ сетевого трафика": "Мониторинг сетевой активности для выявления аномалий, таких как необычный объем запросов или подозрительные подключения.",
    "Регулярное обновление ПО": "Установка патчей и обновлений для программного обеспечения, чтобы закрыть известные уязвимости и повысить безопасность.",
    "Тесты на проникновение": "Симуляция атак на систему для обнаружения слабых мест и скрытых уязвимостей до того, как их найдут хакеры.",
    "Запрет слабых паролей": "Политика, требующая использования сложных и уникальных паролей, чтобы затруднить их подбор хакерами.",
    "Многофакторная аутентификация": "Добавление второго уровня проверки (например, код из SMS) для защиты аккаунтов даже при утечке пароля.",
    "Мониторинг активности пользователей": "Отслеживание действий пользователей в системе для выявления подозрительного поведения или инсайдерских угроз.",
    "Шифрование базы данных": "Защита данных в базе с помощью шифрования, чтобы предотвратить их чтение при несанкционированном доступе.",
    "Удаление неиспользуемых аккаунтов": "Деактивация старых или ненужных учетных записей для снижения риска их использования злоумышленниками.",
    "Обновление ПО из доверенных источников": "Установка обновлений только от проверенных разработчиков, чтобы избежать внедрения вредоносного кода.",
    "Проверка кода перед развертыванием": "Анализ программного кода на уязвимости перед его внедрением в рабочую среду.",
    "Ограничение доступа по IP": "Настройка фильтров, разрешающих подключение только с определенных IP-адресов, для защиты от нежелательного трафика.",
    "Аудит безопасности API": "Тщательная проверка API на наличие уязвимостей, чтобы предотвратить их эксплуатацию хакерами.",
    "Контроль списка устройств": "Ограничение доступа к системе только для заранее утвержденных устройств.",
    "Изоляция IoT в сети": "Разделение 'умных' устройств в отдельную сеть, чтобы ограничить их влияние на основную инфраструктуру.",
    "Проверка цифровых подписей": "Подтверждение подлинности обновлений и программ через цифровые подписи.",
    "Обновление ПО вручную": "Ручная установка обновлений с контролем источников для минимизации риска заражения системы.",
    "Использование VPN": "Шифрование сетевого трафика через виртуальную частную сеть для защиты данных в открытых сетях.",
    "Очистка кэша браузера": "Удаление сохраненных данных браузера, таких как куки, чтобы предотвратить их кражу или использование.",
    "Ограничение времени жизни токенов": "Установка короткого срока действия токенов аутентификации, чтобы снизить их ценность при краже.",
    "Фильтрация DNS-запросов": "Блокировка подозрительных или вредоносных DNS-запросов для предотвращения перенаправлений.",
    "Отключение Bluetooth": "Деактивация Bluetooth на устройствах для устранения связанных с ним уязвимостей.",
    "Отключение автоподключения к Wi-Fi": "Запрет автоматического соединения с Wi-Fi-сетями для защиты от поддельных точек доступа.",
    "Ограничение использования USB": "Блокировка подключения USB-устройств для защиты от внедрения вредоносного ПО.",
    "Мониторинг активности USB-портов": "Отслеживание подключений USB-устройств для быстрого выявления подозрительной активности.",
    "Изоляция подозрительных процессов": "Ограничение работы потенциально опасных программ в изолированной среде.",
    "Антивирус с поведенческим анализом": "Антивирусное ПО, анализирующее поведение программ для обнаружения скрытых угроз и руткитов.",
    "Анализ подозрительных звонков": "Проверка входящих звонков на признаки мошенничества для защиты от вишинга."
}

DEFENSE_MAP = {
    "Фишинговая атака": {"Обучение сотрудников": 2, "Применение DMARC": 1, "Многофакторная аутентификация": 2},
    "DDoS-атака": {"Настройка WAF": 2, "Анализ сетевого трафика": 1, "Ограничение доступа по IP": 1},
    "Эксплойт уязвимости": {"Регулярное обновление ПО": 2, "Тесты на проникновение": 1, "Изоляция подозрительных процессов": 1, "Проверка кода перед развертыванием": 1},
    "Брутфорс-атака": {"Многофакторная аутентификация": 2, "Запрет слабых паролей": 1, "Ограничение времени жизни токенов": 1},
    "Социальная инженерия": {"Обучение сотрудников": 2, "Мониторинг активности пользователей": 1, "Многофакторная аутентификация": 2, "Анализ подозрительных звонков": 1},
    "SQL-инъекция": {"Настройка WAF": 2, "Шифрование базы данных": 1, "Аудит безопасности API": 1, "Проверка кода перед развертыванием": 1},
    "Злоумышленный инсайдер": {"Мониторинг активности пользователей": 2, "Удаление неиспользуемых аккаунтов": 1, "Ограничение доступа по IP": 1, "Многофакторная аутентификация": 1},
    "Атака на цепочку поставок": {"Обновление ПО из доверенных источников": 2, "Проверка кода перед развертыванием": 1, "Проверка цифровых подписей": 2},
    "API-атака": {"Ограничение доступа по IP": 2, "Аудит безопасности API": 1, "Настройка WAF": 2},
    "Злоупотребление доверенными устройствами": {"Контроль списка устройств": 2, "Мониторинг активности пользователей": 1, "Многофакторная аутентификация": 1},
    "Взлом IoT-устройств": {"Изоляция IoT в сети": 2, "Анализ сетевого трафика": 1, "Регулярное обновление ПО": 2},
    "Поддельные обновления": {"Проверка цифровых подписей": 2, "Обновление ПО вручную": 1, "Обновление ПО из доверенных источников": 2},
    "ИИ-атака": {"Запрет слабых паролей": 2, "Обучение сотрудников": 1, "Многофакторная аутентификация": 2, "Анализ сетевого трафика": 1},
    "Кража куки-файлов": {"Использование VPN": 2, "Очистка кэша браузера": 1},
    "Бэкдор": {"Тесты на проникновение": 2, "Мониторинг активности пользователей": 1, "Изоляция подозрительных процессов": 1, "Проверка кода перед развертыванием": 1},
    "DNS-спуфинг": {"Фильтрация DNS-запросов": 2, "Использование VPN": 1},
    "Bluetooth-взлом": {"Отключение Bluetooth": 2, "Анализ сетевого трафика": 1, "Изоляция IoT в сети": 1},
    "Кража токенов доступа": {"Ограничение времени жизни токенов": 2, "Мониторинг активности пользователей": 1, "Использование VPN": 1},
    "Прослушка в общественном Wi-Fi": {"Использование VPN": 2, "Отключение автоподключения к Wi-Fi": 1, "Очистка кэша браузера": 1},
    "USB-атака": {"Ограничение использования USB": 2, "Мониторинг активности USB-портов": 1, "Антивирус с поведенческим анализом": 2},
    "Руткит": {"Изоляция подозрительных процессов": 2, "Антивирус с поведенческим анализом": 1, "Тесты на проникновение": 1, "Регулярное обновление ПО": 1},
    "Vishing": {"Обучение сотрудников": 2, "Анализ подозрительных звонков": 1, "Многофакторная аутентификация": 1}
}

# Генерируем текст описания атакующих карт
ATTACK_CARDS_TEXT = "\n".join(
    [f"{card}: {CARD_DESCRIPTIONS[card]}" for card in ATTACK_CARDS]
)

# Генерируем текст описания защитных карт
DEFENSE_CARDS_TEXT = "\n".join(
    [f"{card}: {CARD_DESCRIPTIONS[card]}" for card in DEFENSE_CARDS]
)